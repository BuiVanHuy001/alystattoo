import {
    album as e,
    artists as a,
    customerReviews as n,
    location as t,
    phoneNumber as i,
    priceList as s,
    process as o,
    socials as r,
    workingHour as l
} from "./data.js";

function renderList(e, a) {
    return e.map(a).join("")
}

function preparePhoneNumber() {
    return `tel:+84${i.replace(/\s+/g, "").replace(/^0/, "")}`
}

function renderPhoneNumber() {
    $(".phone-number").attr("href", preparePhoneNumber()).text(i)
}

function renderAccordion(e) {
    return renderList(e, (a, n) => `<div class="accrodion${0 === n ? " active" : ""}${n === e.length - 1 ? " last-child" : ""}"><div class="accrodion-title"><h4><span>${n + 1}.</span>${a.title}</h4></div><div class="accrodion-content"><div class="inner"><p>${a.content}</p></div></div></div>`)
}

function renderCustomerReviews(e) {
    $("#customerReviews").append(renderList(e, e => `<a class="w-100" href="${e.linkGoogleMap ?? "#"}" target="_blank"><div class="item"><span class="quote"><img src="img/quot.png" loading="lazy" alt=""></span><p class="v-border">${e.content}</p><div class="info"><div class="author-img"><img src="${e.avatar}" loading="lazy" alt=""></div><div class="cont"><h6>${e.name}</h6><span>Đ\xe1nh gi\xe1 kh\xe1ch h\xe0ng</span></div></div></div></a>`))
}

function renderProcess(e) {
    $("#process-container").html(renderAccordion(e))
}

function renderAlbum() {
    $("#gallery").html(e.map((e, a) => `<div class="col-md-${0 === a || 1 === a ? "6" : "4"} gallery-item"><a href="img/gallery/${e.fileName}" title="" class="img-zoom"><div class="gallery-box"><div class="gallery-img"><img src="img/gallery/${e.fileName}" class="img-fluid mx-auto d-block" loading="lazy" alt=""></div></div></a></div>`))
}

function renderPriceList() {
    $("#pricing .content").append(s.map(e => `<div class="menu-list"><div class="item"><div class="flex"><div class="section-subtitle">${e.name}</div><div class="price">${e.price}</div></div><p>${e.desc}</p><div class="dots"></div></div></div>`).join(""))
}

function renderIndexArtists() {
    $("#team .owl-carousel").html(a.map((e, a) => `<div class="item right"><figure><img src="img/team/${e.avatar}" alt="L\xfd Đặng" class="img-fluid"></figure><div class="caption padding-left"><div class="name">${e.name}</div><div class="subname">${e.job}</div><p>${e.desc}</p><a href="${e.link_profile}"class="btn-curve btn-1 mt-10"><span>Xem th\xeam ngay</span></a></div></div>`))
}

function alertError(e) {
    Swal.fire({title: "Lỗi!", text: e, icon: "error", confirmButtonText: "Ok"})
}

function alertSuccess(e) {
    Swal.fire({title: "Th\xe0nh c\xf4ng!", text: e, icon: "success", confirmButtonText: "Tuyệt vời!"}).then(() => {
        location.reload()
    })
}

$(document).ready(function () {
    $(".btn-form1-submit").click(function () {
        let e = $("#name").val(), a = $("#phone").val(), n = $("#date").val(), t = $("#time").val(),
            i = $("#service").val(), s = $("#artist").val();
        if (!e || !a || !n || !t || !i) {
            alertError("Thiếu th\xf4ng tin rồi, điền đủ v\xe0o nha!");
            return
        }
        if (!/^(?:\+84|0)[3|5|7|8|9][0-9]{8}$/.test(a)) {
            alertError("Số điện thoại kh\xf4ng hợp lệ đ\xe2u! Phải từ 10-11 số nha! Y\xean t\xe2m, tụi m\xecnh kh\xf4ng thu thập số điện thoại của bạn đ\xe2u nh\xe9!");
            return
        }
        let [o, r, l] = n.split("/"), c = `${l}-${o}-${r}`, d = new Date(`${c}T${t}`), m = new Date;
        if (isNaN(d.getTime())) {
            alertError("Oop! Coi chừng nha, ng\xe0y hoặc giờ n\xe0y kh\xf4ng hợp lệ đ\xe2u! Kiểm tra lại đi nh\xe9!");
            return
        }
        if (d < m) {
            alertError("Lỗi rồi! Ng\xe0y hoặc giờ bạn chọn đ\xe3 qua rồi, chọn lại c\xe1i kh\xe1c đi nha!");
            return
        }
        let p = `Chốt đơn xăm nghệ thuật đ\xe2y ạ!:
- T\xean t\xf4i: ${e}
- Số điện thoại: ${a}
- Lịch hẹn: ${n}
- Giờ: ${t}
- Dịch vụ chọn: ${i}`;
        0 != s && (p += `
- Thợ xăm: ${s}`);
        let u = `https://m.me/tattoovithanh?text=${encodeURIComponent(p)}`;
        window.open(u, "_blank"), alertSuccess("Th\xf4ng tin đ\xe3 được gửi th\xe0nh c\xf4ng! Cảm ơn bạn, hẹn gặp bạn trong buổi xăm sắp tới nh\xe9!")
    })
}), renderCustomerReviews(n), renderProcess(o), renderAlbum(), renderPriceList(), renderIndexArtists(), renderPhoneNumber(), $(function () {
    $("#preloader").fadeOut(400), $(".preloader-bg").delay(300).fadeOut(400), setTimeout(function () {
        $("#preloader").fadeOut(), $(".preloader-bg").fadeOut(), $(".cd-transition-layer").addClass("closing").delay(1e3).queue(function () {
            $(this).removeClass("visible closing opening").dequeue()
        })
    });

    var e = $(window);
    $.scrollIt({
        upKey: 38,
        downKey: 40,
        easing: "swing",
        scrollTime: 600,
        activeClass: "active",
        onPageChange: null,
        topOffset: -70
    }), e.on("scroll", function () {
        var a = e.scrollTop(), n = $(".navbar"), t = $(".navbar .logo> img");
        a > 100 ? (n.addClass("nav-scroll"), t.attr("src", "img/alysTattooLogo.png")) : (n.removeClass("nav-scroll"), t.attr("src", "img/alysTattooLogo.png"))
    }), $(".navbar-nav .dropdown-item a").on("click", function () {
        $(".navbar-collapse").removeClass("show")
    }), $(function () {
        var e = $(".navbar-collapse");
        e.on("click", "a", null, function () {
            e.collapse("hide")
        })
    }), $(".bg-img, section").each(function (e) {
        $(this).attr("data-background") && $(this).css("background-image", "url(" + $(this).data("background") + ")")
    });
    var a = function () {
        var e = 0;
        $(".animate-box").waypoint(function (a) {
            "down" !== a || $(this.element).hasClass("animated") || (e++, $(this.element).addClass("item-animate"), setTimeout(function () {
                $("body .animate-box.item-animate").each(function (e) {
                    var a = $(this);
                    setTimeout(function () {
                        var e = a.data("animate-effect");
                        "fadeIn" === e ? a.addClass("fadeIn animated") : "fadeInLeft" === e ? a.addClass("fadeInLeft animated") : "fadeInRight" === e ? a.addClass("fadeInRight animated") : a.addClass("fadeInUp animated"), a.removeClass("item-animate")
                    }, 200 * e, "easeInOutExpo")
                })
            }, 100))
        }, {offset: "85%"})
    };
    $(function () {
        a()
    }), $("a.vid").YouTubePopUp(), $(".testimonials .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !1,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 1}, 1e3: {items: 1}}
    }), $(".team .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !0,
        autoplayHoverPause: !0,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 1}, 1e3: {items: 1}}
    }), $(".clients .owl-carousel").owlCarousel({
        loop: !0,
        margin: 10,
        mouseDrag: !0,
        autoplay: !0,
        dots: !1,
        responsiveClass: !0,
        responsive: {0: {margin: 10, items: 3}, 600: {items: 4}, 1e3: {items: 5}}
    }), $(".gallery .owl-carousel").owlCarousel({
        loop: !0,
        margin: 10,
        mouseDrag: !0,
        autoplay: !1,
        dots: !1,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 2}, 1e3: {items: 3}}
    }), $(".blog .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !0,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 2}, 1e3: {items: 2}}
    }), $(".img-zoom").magnificPopup({
        type: "image",
        closeOnContentClick: !0,
        mainClass: "mfp-fade",
        gallery: {enabled: !0, navigateByImgClick: !0, preload: [0, 1]}
    }), $(".magnific-youtube, .magnific-vimeo, .magnific-custom").magnificPopup({
        disableOn: 700,
        type: "iframe",
        mainClass: "mfp-fade",
        removalDelay: 300,
        preloader: !1,
        fixedContentPos: !1
    }), $('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function (e) {
        if (t.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && t.hostname == this.hostname) {
            var a = $(this.hash);
            (a = a.length ? a : $("[name=" + this.hash.slice(1) + "]")).length && (e.preventDefault(), $("html, body").animate({scrollTop: a.offset().top}, 1e3, function () {
                var e = $(a);
                if (e.focus(), e.is(":focus")) return !1;
                e.attr("tabindex", "-1"), e.focus()
            }))
        }
    });
    var n = document.querySelector(".progress-wrap path"), i = n.getTotalLength();
    n.style.transition = n.style.WebkitTransition = "none", n.style.strokeDasharray = i + " " + i, n.style.strokeDashoffset = i, n.getBoundingClientRect(), n.style.transition = n.style.WebkitTransition = "stroke-dashoffset 10ms linear";
    var s = function () {
        var e = $(window).scrollTop(), a = $(document).height() - $(window).height();
        n.style.strokeDashoffset = i - e * i / a
    };
    s(), $(window).scroll(s), jQuery(window).on("scroll", function () {
        jQuery(this).scrollTop() > 150 ? jQuery(".progress-wrap").addClass("active-progress") : jQuery(".progress-wrap").removeClass("active-progress")
    }), jQuery(".progress-wrap").on("click", function (e) {
        return e.preventDefault(), jQuery("html, body").animate({scrollTop: 0}, 550), !1
    }), $(document).ready(function () {
        var e = $(".header .owl-carousel");
        $(".slider .owl-carousel").owlCarousel({
            items: 1,
            loop: !0,
            dots: !1,
            margin: 0,
            autoplay: !0,
            autoplayTimeout: 2000,
            smartSpeed: 1000,
            nav: !0,
            navText: ['<i class="ti-angle-left" aria-hidden="true"></i>', '<i class="ti-angle-right" aria-hidden="true"></i>']
        }), $(".slider-fade .owl-carousel").owlCarousel({
            items: 1,
            loop: !0,
            dots: !1,
            margin: 0,
            autoplay: !0,
            smartSpeed: 1000,
            autoplayTimeout: 2000,
            animateOut: "fadeOut",
            nav: !0,
            navText: ['<i class="ti-angle-left" aria-hidden="true"></i>', '<i class="ti-angle-right" aria-hidden="true"></i>']
        }), e.on("changed.owl.carousel", function (e) {
            var a = e.item.index - 2;
            $("h6").removeClass("animated fadeInUp"), $("h1").removeClass("animated fadeInUp"), $("p").removeClass("animated fadeInUp"), $(".btn-curve").removeClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(a).find("h6").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(a).find("h1").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(a).find("p").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(a).find(".btn-curve").addClass("animated fadeInUp")
        })
    }), $(".accordion-box").length && $(".accordion-box").on("click", ".acc-btn", function () {
        var e = $(this).parents(".accordion-box"), a = $(this).parents(".accordion");
        $(this).next(".acc-content").is(":visible") ? ($(this).removeClass("active"), $(this).next(".acc-content").slideUp(300), $(e).children(".accordion").removeClass("active-block")) : ($(e).find(".accordion .acc-btn").removeClass("active"), $(this).addClass("active"), $(e).children(".accordion").removeClass("active-block"), $(e).find(".accordion").children(".acc-content").slideUp(300), a.addClass("active-block"), $(this).next(".acc-content").slideDown(300))
    });
    var o, r = $(".contact__form"), l = $(".contact__msg");

    function c(e) {
        l.fadeIn().removeClass("alert-danger").addClass("alert-success"), l.text(e), setTimeout(function () {
            l.fadeOut()
        }, 2e3), r.find('input:not([type="submit"]), textarea').val("")
    }

    function d(e) {
        l.fadeIn().removeClass("alert-success").addClass("alert-success"), l.text(e.responseText), setTimeout(function () {
            l.fadeOut()
        }, 2e3)
    }

    r.submit(function (e) {
        e.preventDefault(), o = $(this).serialize(), $.ajax({
            type: "POST",
            url: r.attr("action"),
            data: o
        }).done(c).fail(d)
    }), $(".select2").select2({minimumResultsForSearch: 1 / 0}), $(".datepicker").datepicker({orientation: "top"}), $(".accrodion-grp").length && $(".accrodion-grp").each(function () {
        var e = $(this).data("grp-name"), a = $(this), n = a.find(".accrodion");
        a.addClass(e), a.find(".accrodion .accrodion-content").hide(), a.find(".accrodion.active").find(".accrodion-content").show(), n.each(function () {
            $(this).find(".accrodion-title").on("click", function () {
                !1 === $(this).parent().hasClass("active") && ($(".accrodion-grp." + e).find(".accrodion").removeClass("active"), $(".accrodion-grp." + e).find(".accrodion").find(".accrodion-content").slideUp(), $(this).parent().addClass("active"), $(this).parent().find(".accrodion-content").slideDown())
            })
        })
    }), $(".accordion").on("click", ".title", function () {
        $(this).next().slideDown(), $(".accordion-info").not($(this).next()).slideUp()
    }), $(".accordion").on("click", ".item", function () {
        $(this).addClass("active").siblings().removeClass("active")
    })
})