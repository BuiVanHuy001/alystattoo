import {
    album as o,
    artists as r,
    customerReviews as n,
    location as i,
    phoneNumber as e,
    priceList as l,
    process as a,
    socials as t,
    workingHour as s
} from "./data.js";

function renderList(a, e) {
    return a.map(e).join("")
}

function preparePhoneNumber() {
    return `tel:+84${e.replace(/\s+/g, "").replace(/^0/, "")}`
}

function renderPhoneNumber() {
    $(".phone-number").attr("href", preparePhoneNumber()).text(e)
}

function renderFooterContact(a) {
    let {address: i, linkGoogleMap: n, miniMap: s} = a;
    return `<div class="col-md-3"><div class="footer-column footer-contact"><h3 class="footer-title">Liên hệ</h3><p class="footer-contact-text"><a class="address-link" href="${n}" target="_blank">${i}</a></p><div class="footer-contact-info"><p class="footer-contact-phone"><a class="phone-number" href="${preparePhoneNumber()}">${e}</a></p></div><div class="footer-about-social-list">${renderSocialLinks(t)}</div></div></div>`
}

function renderSocialLinks(a) {
    return renderList(a, a => `<a href="${a.link}" target="_blank">${a.icon ? `<i class="${a.icon}"></i>` : '<img src="img/tiktok-logo.svg" style="width: 15px; height: 15px" alt="" loading="lazy">'}</a>`)
}

function renderWorkingHours(a) {
    return `<div class="col-md-3 offset-md-1"><div class="item opening"><h3 class="footer-title">Thời gian làm việc</h3><ul>${renderList(a, a => `<li><div class="tit">${a.name}</div><div class="dots"></div><span>${a.time}</span></li>`)}</ul></div></div>`
}

function renderAccordion(a) {
    return renderList(a, (e, i) => `<div class="accrodion${0 === i ? " active" : ""}${i === a.length - 1 ? " last-child" : ""}"><div class="accrodion-title"><h4><span>${i + 1}.</span>${e.title}</h4></div><div class="accrodion-content"><div class="inner"><p>${e.content}</p></div></div></div>`)
}

function renderFooter(a, e) {
    let i = `<div class="footer-top"><div class="container"><div class="row">${renderFooterContact(a)}${renderWorkingHours(e)}<div class="col-md-4 offset-md-1" id="miniMap">${a.miniMap}</div></div></div></div>`;
    $("footer").html(i)
}

function renderCustomerReviews(a) {
    $("#customerReviews").append(renderList(a, a => `<a class="w-100" href="${a.linkGoogleMap ?? "#"}" target="_blank"><div class="item"><span class="quote"><img src="img/quot.png" loading="lazy" alt=""></span><p class="v-border">${a.content}</p><div class="info"><div class="author-img"><img src="${a.avatar}" loading="lazy" alt=""></div><div class="cont"><h6>${a.name}</h6><span>Đ\xe1nh gi\xe1 kh\xe1ch h\xe0ng</span></div></div></div></a>`))
}

function renderProcess(a) {
    $("#process-container").html(renderAccordion(a))
}

function renderAlbum() {
    $("#gallery").html(o.map((a, e) => `<div class="col-md-${0 === e || 1 === e ? "6" : "4"} gallery-item"><a href="img/gallery/${a.fileName}" title="" class="img-zoom"><div class="gallery-box"><div class="gallery-img"><img src="img/gallery/${a.fileName}" class="img-fluid mx-auto d-block" loading="lazy" alt=""></div></div></a></div>`))
}

function renderPriceList() {
    $("#pricing .content").append(l.map(a => `<div class="menu-list"><div class="item"><div class="flex"><div class="section-subtitle">${a.name}</div><div class="price">${a.price}</div></div><p>${a.desc}</p><div class="dots"></div></div></div>`).join(""))
}

function renderIndexArtists() {
    $("#team .owl-carousel").html(r.map((a, e) => `<div class="item right"><figure><img src="img/team/${a.avatar}" loading="lazy" alt="L\xfd Đặng" class="img-fluid"></figure><div class="caption padding-left"><div class="name">${a.name}</div><div class="subname">${a.job}</div><p>${a.desc}</p><a href="${a.link_profile}"class="btn-curve btn-1 mt-10"><span>Xem th\xeam ngay</span></a></div></div>`))
}

function alertError(msg) {
    Swal.fire({title: 'Lỗi!', text: msg, icon: 'error', confirmButtonText: 'Ok'})
}

function alertSuccess(msg) {
    Swal.fire({title: 'Thành công!', text: msg, icon: 'success', confirmButtonText: 'Tuyệt vời!'}).then(() => {
        location.reload()
    })
}

$(document).ready(function () {
    $('.btn-form1-submit').click(function () {
        const name = $('#name').val();
        const phone = $('#phone').val();
        const date = $('#date').val();
        const time = $('#time').val();
        const service = $('#service').val();
        const artist = $('#artist').val();
        if (!name || !phone || !date || !time || !service) {
            alertError('Thiếu thông tin rồi, điền đủ vào nha!');
            return
        }
        const phoneRegex = /^(?:\+84|0)[3|5|7|8|9][0-9]{8}$/;
        if (!phoneRegex.test(phone)) {
            alertError('Số điện thoại không hợp lệ đâu! Phải từ 10-11 số nha! Yên tâm, tụi mình không thu thập số điện thoại của bạn đâu nhé!');
            return
        }
        const [month, day, year] = date.split('/');
        const formattedDate = `${year}-${month}-${day}`;
        const selectedDateTime = new Date(`${formattedDate}T${time}`);
        const currentDateTime = new Date();
        if (isNaN(selectedDateTime.getTime())) {
            alertError('Oop! Coi chừng nha, ngày hoặc giờ này không hợp lệ đâu! Kiểm tra lại đi nhé!');
            return
        }
        if (selectedDateTime < currentDateTime) {
            alertError('Lỗi rồi! Ngày hoặc giờ bạn chọn đã qua rồi, chọn lại cái khác đi nha!');
            return
        }
        let message = `Chốt đơn xăm nghệ thuật đây ạ!:\n- Tên tôi: ${name}\n- Số điện thoại: ${phone}\n- Lịch hẹn: ${date}\n- Giờ: ${time}\n- Dịch vụ chọn: ${service}`;
        if (artist != 0) {
            message += `\n- Thợ xăm: ${artist}`
        }
        const messengerUrl = `https://m.me/tattoovithanh?text=${encodeURIComponent(message)}`;
        window.open(messengerUrl, '_blank');
        alertSuccess('Thông tin đã được gửi thành công! Cảm ơn bạn, hẹn gặp bạn trong buổi xăm sắp tới nhé!')
    })
});
renderFooter(i, s), renderCustomerReviews(n), renderProcess(a), renderAlbum(), renderPriceList(), renderIndexArtists(), renderPhoneNumber(), $(function () {
    $("#preloader").fadeOut(400), $(".preloader-bg").delay(300).fadeOut(400), setTimeout(function () {
        $("#preloader").fadeOut(), $(".preloader-bg").fadeOut(), $(".cd-transition-layer").addClass("closing").delay(1e3).queue(function () {
            $(this).removeClass("visible closing opening").dequeue()
        })
    });
    var a = $(window);
    $.scrollIt({
        upKey: 38,
        downKey: 40,
        easing: "swing",
        scrollTime: 600,
        activeClass: "active",
        onPageChange: null,
        topOffset: -70
    }), a.on("scroll", function () {
        var e = a.scrollTop(), i = $(".navbar"), t = $(".navbar .logo> img");
        e > 100 ? (i.addClass("nav-scroll"), t.attr("src", "img/alysTattooLogo.png")) : (i.removeClass("nav-scroll"), t.attr("src", "img/alysTattooLogo.png"))
    }), $(".navbar-nav .dropdown-item a").on("click", function () {
        $(".navbar-collapse").removeClass("show")
    }), $(function () {
        var a = $(".navbar-collapse");
        a.on("click", "a", null, function () {
            a.collapse("hide")
        })
    }), $(".bg-img, section").each(function (a) {
        $(this).attr("data-background") && $(this).css("background-image", "url(" + $(this).data("background") + ")")
    });
    var e = function () {
        var a = 0;
        $(".animate-box").waypoint(function (e) {
            "down" !== e || $(this.element).hasClass("animated") || (a++, $(this.element).addClass("item-animate"), setTimeout(function () {
                $("body .animate-box.item-animate").each(function (a) {
                    var e = $(this);
                    setTimeout(function () {
                        var a = e.data("animate-effect");
                        "fadeIn" === a ? e.addClass("fadeIn animated") : "fadeInLeft" === a ? e.addClass("fadeInLeft animated") : "fadeInRight" === a ? e.addClass("fadeInRight animated") : e.addClass("fadeInUp animated"), e.removeClass("item-animate")
                    }, 200 * a, "easeInOutExpo")
                })
            }, 100))
        }, {offset: "85%"})
    };
    $(function () {
        e()
    }), $("a.vid").YouTubePopUp(), $(".testimonials .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !1,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 1}, 1e3: {items: 1}}
    }), $(".team .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !0,
        autoplayHoverPause: !0,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 1}, 1e3: {items: 1}}
    }), $(".clients .owl-carousel").owlCarousel({
        loop: !0,
        margin: 10,
        mouseDrag: !0,
        autoplay: !0,
        dots: !1,
        responsiveClass: !0,
        responsive: {0: {margin: 10, items: 3}, 600: {items: 4}, 1e3: {items: 5}}
    }), $(".gallery .owl-carousel").owlCarousel({
        loop: !0,
        margin: 10,
        mouseDrag: !0,
        autoplay: !1,
        dots: !1,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 2}, 1e3: {items: 3}}
    }), $(".blog .owl-carousel").owlCarousel({
        loop: !0,
        margin: 30,
        mouseDrag: !0,
        autoplay: !1,
        dots: !0,
        nav: !1,
        navText: ["<span class='lnr ti-angle-left'></span>", "<span class='lnr ti-angle-right'></span>"],
        responsiveClass: !0,
        responsive: {0: {items: 1}, 600: {items: 2}, 1e3: {items: 2}}
    }), $(".img-zoom").magnificPopup({
        type: "image",
        closeOnContentClick: !0,
        mainClass: "mfp-fade",
        gallery: {enabled: !0, navigateByImgClick: !0, preload: [0, 1]}
    }), $(".magnific-youtube, .magnific-vimeo, .magnific-custom").magnificPopup({
        disableOn: 700,
        type: "iframe",
        mainClass: "mfp-fade",
        removalDelay: 300,
        preloader: !1,
        fixedContentPos: !1
    }), $('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function (a) {
        if (i.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && i.hostname == this.hostname) {
            var e = $(this.hash);
            (e = e.length ? e : $("[name=" + this.hash.slice(1) + "]")).length && (a.preventDefault(), $("html, body").animate({scrollTop: e.offset().top}, 1e3, function () {
                var a = $(e);
                if (a.focus(), a.is(":focus")) return !1;
                a.attr("tabindex", "-1"), a.focus()
            }))
        }
    });
    var t = document.querySelector(".progress-wrap path"), n = t.getTotalLength();
    t.style.transition = t.style.WebkitTransition = "none", t.style.strokeDasharray = n + " " + n, t.style.strokeDashoffset = n, t.getBoundingClientRect(), t.style.transition = t.style.WebkitTransition = "stroke-dashoffset 10ms linear";
    var s = function () {
        var a = $(window).scrollTop(), e = $(document).height() - $(window).height();
        t.style.strokeDashoffset = n - a * n / e
    };
    s(), $(window).scroll(s), jQuery(window).on("scroll", function () {
        jQuery(this).scrollTop() > 150 ? jQuery(".progress-wrap").addClass("active-progress") : jQuery(".progress-wrap").removeClass("active-progress")
    }), jQuery(".progress-wrap").on("click", function (a) {
        return a.preventDefault(), jQuery("html, body").animate({scrollTop: 0}, 550), !1
    }), $(document).ready(function () {
        var a = $(".header .owl-carousel");
        $(".slider .owl-carousel").owlCarousel({
            items: 1,
            loop: !0,
            dots: !1,
            margin: 0,
            autoplay: !1,
            autoplayTimeout: 6e3,
            smartSpeed: 500,
            nav: !0,
            navText: ['<i class="ti-angle-left" aria-hidden="true"></i>', '<i class="ti-angle-right" aria-hidden="true"></i>']
        }), $(".slider-fade .owl-carousel").owlCarousel({
            items: 1,
            loop: !0,
            dots: !1,
            margin: 0,
            autoplay: !1,
            smartSpeed: 500,
            autoplayTimeout: 6e3,
            animateOut: "fadeOut",
            nav: !0,
            navText: ['<i class="ti-angle-left" aria-hidden="true"></i>', '<i class="ti-angle-right" aria-hidden="true"></i>']
        }), a.on("changed.owl.carousel", function (a) {
            var e = a.item.index - 2;
            $("h6").removeClass("animated fadeInUp"), $("h1").removeClass("animated fadeInUp"), $("p").removeClass("animated fadeInUp"), $(".btn-curve").removeClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(e).find("h6").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(e).find("h1").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(e).find("p").addClass("animated fadeInUp"), $(".owl-item").not(".cloned").eq(e).find(".btn-curve").addClass("animated fadeInUp")
        })
    }), $(".accordion-box").length && $(".accordion-box").on("click", ".acc-btn", function () {
        var a = $(this).parents(".accordion-box"), e = $(this).parents(".accordion");
        $(this).next(".acc-content").is(":visible") ? ($(this).removeClass("active"), $(this).next(".acc-content").slideUp(300), $(a).children(".accordion").removeClass("active-block")) : ($(a).find(".accordion .acc-btn").removeClass("active"), $(this).addClass("active"), $(a).children(".accordion").removeClass("active-block"), $(a).find(".accordion").children(".acc-content").slideUp(300), e.addClass("active-block"), $(this).next(".acc-content").slideDown(300))
    });
    var o, l = $(".contact__form"), r = $(".contact__msg");

    function c(a) {
        r.fadeIn().removeClass("alert-danger").addClass("alert-success"), r.text(a), setTimeout(function () {
            r.fadeOut()
        }, 2e3), l.find('input:not([type="submit"]), textarea').val("")
    }

    function d(a) {
        r.fadeIn().removeClass("alert-success").addClass("alert-success"), r.text(a.responseText), setTimeout(function () {
            r.fadeOut()
        }, 2e3)
    }

    l.submit(function (a) {
        a.preventDefault(), o = $(this).serialize(), $.ajax({
            type: "POST",
            url: l.attr("action"),
            data: o
        }).done(c).fail(d)
    }), $(".select2").select2({minimumResultsForSearch: 1 / 0}), $(".datepicker").datepicker({orientation: "top"}), $(".accrodion-grp").length && $(".accrodion-grp").each(function () {
        var a = $(this).data("grp-name"), e = $(this), i = e.find(".accrodion");
        e.addClass(a), e.find(".accrodion .accrodion-content").hide(), e.find(".accrodion.active").find(".accrodion-content").show(), i.each(function () {
            $(this).find(".accrodion-title").on("click", function () {
                !1 === $(this).parent().hasClass("active") && ($(".accrodion-grp." + a).find(".accrodion").removeClass("active"), $(".accrodion-grp." + a).find(".accrodion").find(".accrodion-content").slideUp(), $(this).parent().addClass("active"), $(this).parent().find(".accrodion-content").slideDown())
            })
        })
    }), $(".accordion").on("click", ".title", function () {
        $(this).next().slideDown(), $(".accordion-info").not($(this).next()).slideUp()
    }), $(".accordion").on("click", ".item", function () {
        $(this).addClass("active").siblings().removeClass("active")
    })
})